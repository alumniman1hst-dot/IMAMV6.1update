import{r as l,c as p,U as x,t as i,j as e,B as m,f as I,m as M,O as S,e as C,a5 as J,i as A}from"./index-CcQVG4nr.js";import{L as D}from"./Layout-aA6jRwwe.js";import{g as K,a as P}from"./academicService-BlZ1ib-Y.js";const G=({onBack:j,userRole:c})=>{const[b,f]=l.useState([]),[N,u]=l.useState(!0),[U,B]=l.useState(!1),[o,h]=l.useState("history"),[t,r]=l.useState({className:"X IPA 1",subject:"Matematika",date:new Date().toISOString().split("T")[0],jamKe:"1-2",materi:"",catatan:""}),k=c===x.GURU||c===x.ADMIN;l.useEffect(()=>{g()},[]);const g=async()=>{var a,n;u(!0);try{const d=(n=(a=p)==null?void 0:a.currentUser)==null?void 0:n.uid,s=await K(c===x.ADMIN?void 0:d||"mock-teacher-1");f(s)}catch{i.error("Gagal memuat jurnal.")}finally{u(!1)}},v=async a=>{var d;if(a.preventDefault(),!t.materi){i.error("Materi harus diisi");return}const n=i.loading("Menyimpan jurnal...");try{const s=(d=p)==null?void 0:d.currentUser,w=(s==null?void 0:s.displayName)||(A?"Budi Santoso, S.Pd":"Guru"),y=(s==null?void 0:s.uid)||"mock-teacher-1";await P({teacherId:y,teacherName:w,className:t.className,subject:t.subject,date:t.date,jamKe:t.jamKe,materi:t.materi,catatan:t.catatan||"Nihil"}),i.success("Jurnal berhasil disimpan",{id:n}),r({...t,materi:"",catatan:""}),h("history"),g()}catch(s){console.error(s),i.error("Gagal menyimpan jurnal",{id:n})}};return e.jsx(D,{title:"Jurnal Mengajar",subtitle:"Catatan Aktivitas Kelas",icon:m,onBack:j,actions:k&&e.jsx("button",{onClick:()=>h(o==="create"?"history":"create"),className:`px-4 py-2 rounded-xl text-xs font-bold flex items-center gap-2 transition-colors ${o==="create"?"bg-slate-200 text-slate-700":"bg-indigo-600 text-white shadow-lg"}`,children:o==="create"?"Lihat Riwayat":e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-4 h-4"})," Input Jurnal"]})}),children:e.jsx("div",{className:"p-4 lg:p-6 pb-24",children:o==="create"?e.jsxs("div",{className:"max-w-xl mx-auto bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-700 p-6 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("h3",{className:"font-bold text-lg text-slate-800 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5 text-indigo-500"})," Form Jurnal Harian"]}),e.jsxs("form",{onSubmit:v,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Tanggal"}),e.jsx("input",{type:"date",value:t.date,onChange:a=>r({...t,date:a.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Jam Ke-"}),e.jsx("input",{type:"text",value:t.jamKe,onChange:a=>r({...t,jamKe:a.target.value}),placeholder:"1-2",className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Kelas"}),e.jsxs("select",{value:t.className,onChange:a=>r({...t,className:a.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none",children:[e.jsx("option",{children:"X IPA 1"}),e.jsx("option",{children:"X IPA 2"}),e.jsx("option",{children:"XI IPS 1"}),e.jsx("option",{children:"XII AGAMA"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Mata Pelajaran"}),e.jsx("input",{type:"text",value:t.subject,onChange:a=>r({...t,subject:a.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Materi / Pokok Bahasan"}),e.jsx("textarea",{rows:3,value:t.materi,onChange:a=>r({...t,materi:a.target.value}),placeholder:"Jelaskan materi yang diajarkan...",className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Catatan Kejadian (Opsional)"}),e.jsx("textarea",{rows:2,value:t.catatan,onChange:a=>r({...t,catatan:a.target.value}),placeholder:"Siswa sakit, izin, atau kejadian khusus...",className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none resize-none"})]}),e.jsx("button",{type:"submit",className:"w-full py-3.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg transition-all active:scale-95",children:"Simpan Jurnal"})]})]}):e.jsx("div",{className:"space-y-4",children:N?e.jsx("p",{className:"text-center text-slate-400 py-10",children:"Memuat jurnal..."}):b.length>0?b.map(a=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-white text-base",children:a.subject}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-slate-500 dark:text-slate-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-3 h-3"})," ",new Date(a.date).toLocaleDateString("id-ID",{weekday:"short",day:"numeric",month:"short"})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-3 h-3"})," Jam ke-",a.jamKe]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"})," ",a.className]})]})]}),e.jsx("div",{className:"w-10 h-10 bg-indigo-50 dark:bg-indigo-900/20 rounded-full flex items-center justify-center text-indigo-600 dark:text-indigo-400",children:e.jsx(m,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 mb-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Materi"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed",children:a.materi})]}),a.catatan&&e.jsxs("div",{className:"flex items-start gap-2 text-xs text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/10 p-2 rounded-lg",children:[e.jsx("span",{className:"font-bold shrink-0",children:"Catatan:"}),e.jsx("span",{children:a.catatan})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center text-xs text-slate-400",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"})," ",a.teacherName]})})]},a.id)):e.jsx("div",{className:"text-center py-20 bg-white dark:bg-slate-800 rounded-3xl border border-dashed border-slate-200 dark:border-slate-700",children:e.jsx("p",{className:"text-slate-500",children:"Belum ada jurnal mengajar."})})})})})};export{G as default};
