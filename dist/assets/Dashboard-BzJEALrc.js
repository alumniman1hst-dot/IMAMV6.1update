import{r as l,V as r,f as A,B as E,U as s,Q as D,g as C,E as M,h as T,j as e,k as L,l as R,C as U,m as P,o as O,p as _,I as H,c as d,i as G,d as u}from"./index-CcQVG4nr.js";import{f as K}from"./format-DylC2ZLE.js";const W=({onNavigate:i,userRole:o,onLogout:x})=>{const[m,b]=l.useState("Pengguna"),[B,$]=l.useState(null),[c,p]=l.useState({students:0,teachers:0,classes:0,pendingLetters:0,male:0,female:0}),[F,N]=l.useState([]),[Q,h]=l.useState(!0),[g,k]=l.useState(null),v=l.useRef(null),f=o===s.SISWA;l.useEffect(()=>{(async()=>{if(h(!0),d.currentUser&&b(d.currentUser.displayName||"Pengguna"),G){setTimeout(()=>{p({students:842,teachers:56,classes:24,pendingLetters:5,male:410,female:432}),N([{day:"M",val:80},{day:"S",val:95},{day:"S",val:90}]),h(!1)},800);return}if(u)try{const n=await u.collection("settings").doc("global_stats").get();if(n.exists){const a=n.data();p({students:(a==null?void 0:a.totalStudents)||0,teachers:(a==null?void 0:a.totalTeachers)||0,classes:(a==null?void 0:a.totalClasses)||0,pendingLetters:(a==null?void 0:a.totalPendingLetters)||0,male:(a==null?void 0:a.totalMale)||0,female:(a==null?void 0:a.totalFemale)||0})}if(d.currentUser){const a=K(new Date,"yyyy-MM-dd"),j=await u.collection("attendance").where("studentId","==",d.currentUser.uid).where("date","==",a).limit(1).get();j.empty||k(j.docs[0].data())}}catch(n){console.error("Dashboard Quota Optimization Error:",n)}finally{h(!1)}})()},[]);const y="https://lh3.googleusercontent.com/d/1nUuvSSEI4pj7YZd_Hy4iSO62LM-_KuoE",S=t=>!t||t.includes(o),I=[{label:"Jadwal",icon:A,view:r.SCHEDULE,color:"text-orange-600",bg:"bg-orange-50"},{label:"Tugas",icon:E,view:r.ASSIGNMENTS,color:"text-violet-600",bg:"bg-violet-50"},{label:"Presensi",icon:D,view:r.SCANNER,color:"text-teal-600",bg:"bg-teal-50",roles:[s.ADMIN,s.DEVELOPER,s.GURU,s.STAF_TU,s.WALI_KELAS,s.KEPALA_MADRASAH]},{label:"Nilai",icon:C,view:r.REPORT_CARDS,color:"text-emerald-600",bg:"bg-emerald-50"},{label:"Surat",icon:M,view:r.LETTERS,color:"text-sky-600",bg:"bg-sky-50"},{label:"Laporan",icon:T,view:r.REPORTS,color:"text-slate-600",bg:"bg-slate-100",roles:[s.ADMIN,s.DEVELOPER,s.KEPALA_MADRASAH]}].filter(t=>S(t.roles));return e.jsxs("div",{className:"flex flex-col h-full bg-[#f8fafc] dark:bg-[#020617] overflow-hidden transition-colors duration-300",children:[e.jsxs("div",{className:"px-6 pt-12 pb-6 bg-white dark:bg-[#0B1121] rounded-b-[2.5rem] border-b border-slate-100 dark:border-slate-800/50 sticky top-0 z-40",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"IMAM v6.2 Active"})]}),e.jsxs("h1",{className:"text-2xl font-black text-slate-900 dark:text-white leading-tight truncate",children:["Halo, ",m.split(" ")[0],"!"]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-[10px] font-bold border border-indigo-100 dark:border-indigo-800",children:o})})]}),e.jsxs("div",{className:"flex gap-2.5",children:[e.jsx("button",{onClick:()=>i(r.SETTINGS),className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-2xl text-slate-500 border border-slate-100 dark:border-slate-800 active:scale-90 transition-all",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsx("button",{onClick:x,className:"p-3 bg-rose-50 dark:bg-rose-900/20 rounded-2xl text-rose-600 border border-rose-100 dark:border-rose-900/30 active:scale-90 transition-all",children:e.jsx(R,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{ref:v,className:"flex overflow-x-auto gap-4 pb-4 scrollbar-hide -mx-6 px-6 snap-x snap-mandatory",children:[f&&e.jsxs("div",{onClick:()=>i(r.ATTENDANCE_HISTORY),className:"min-w-[280px] snap-center bg-indigo-600 rounded-[2.5rem] p-6 text-white shadow-xl cursor-pointer relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10 rotate-12",children:e.jsx(U,{className:"w-24 h-24"})}),e.jsx("p",{className:"text-[10px] font-bold opacity-70 mb-1 uppercase tracking-widest",children:"Kehadiran Hari Ini"}),e.jsx("h3",{className:"text-xl font-black mb-4",children:g?g.status:"Belum Absen"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] font-bold bg-white/20 px-4 py-1.5 rounded-xl",children:"Lihat Riwayat"}),e.jsx(P,{className:"w-4 h-4 opacity-40"})]})]}),!f&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative min-w-[300px] snap-center rounded-[2.5rem] bg-[#0F172A] text-white shadow-2xl h-[160px] flex flex-col justify-end overflow-hidden border border-white/10 p-6",children:[e.jsx("img",{src:y,className:"absolute inset-0 w-full h-full object-cover object-top opacity-40"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#020617] to-transparent"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("span",{className:"text-[9px] font-bold text-yellow-400 uppercase tracking-widest",children:"Kepala Madrasah"}),e.jsx("h4",{className:"text-base font-black uppercase",children:"H. Someran, S.Pd.,MM"})]})]}),e.jsx(w,{label:"Peserta Didik",val:c.students,icon:O,grad:"from-blue-600 to-indigo-800",detail:`${c.male} L • ${c.female} P`}),e.jsx(w,{label:"Total Guru",val:c.teachers,icon:_,grad:"from-emerald-600 to-teal-800",detail:"GTK Terverifikasi"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 pb-40",children:[e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-6 animate-in fade-in duration-700",children:I.map((t,n)=>e.jsxs("button",{onClick:()=>i(t.view),className:"flex flex-col items-center gap-2 group outline-none",children:[e.jsx("div",{className:`w-14 h-14 rounded-[1.8rem] flex items-center justify-center shadow-sm border border-black/5 active:scale-90 transition-all ${t.bg} dark:bg-slate-800`,children:e.jsx(t.icon,{className:`w-6 h-6 ${t.color}`})}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 text-center truncate w-full",children:t.label})]},n))}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/10 border border-indigo-100 dark:border-indigo-900/50 rounded-[2.5rem] p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-2xl bg-indigo-600 text-white flex items-center justify-center shadow-lg",children:e.jsx(H,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-sm font-black text-slate-800 dark:text-white uppercase tracking-tight",children:"Petunjuk Cepat"})]}),e.jsxs("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 leading-relaxed",children:["Gunakan menu ",e.jsx("b",{children:"Scan QR"})," untuk melakukan absensi harian. Siswa cukup menunjukkan ",e.jsx("b",{children:"ID Digital"})," yang ada di menu akun. Data akan tersinkronisasi secara otomatis ke database pusat."]})]})]})]})},w=({label:i,val:o,icon:x,grad:m,detail:b})=>e.jsxs("div",{className:`relative min-w-[260px] snap-center p-6 rounded-[2.5rem] bg-gradient-to-br ${m} text-white shadow-xl h-[160px] flex flex-col justify-between overflow-hidden`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center border border-white/10",children:e.jsx(x,{className:"w-5 h-5"})}),e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded text-[8px] font-bold uppercase tracking-widest",children:"Master"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-black",children:o}),e.jsxs("p",{className:"text-[9px] font-bold opacity-60 uppercase tracking-widest",children:[i," • ",b]})]})]});export{W as default};
