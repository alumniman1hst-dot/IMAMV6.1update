import{r as n,j as e,O as I,a as S,s as q,W as A,y as F,x as C,a3 as O,a6 as Q,A as Z,C as ee,e as ae,Y as se,ao as te,i as D,c as V,d as f,U,t as c}from"./index-CcQVG4nr.js";import{L as ie}from"./Layout-aA6jRwwe.js";const j=({label:N,icon:w,value:x,onChange:p,placeholder:m,type:u="text"})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest ml-1",children:N}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute left-4 top-3.5 text-slate-400 group-focus-within:text-indigo-500 transition-colors",children:e.jsx(w,{className:"w-4 h-4"})}),u==="textarea"?e.jsx("textarea",{rows:3,value:x||"",onChange:g=>p(g.target.value),placeholder:m,className:"w-full bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-2xl py-3.5 pl-12 pr-4 text-[11px] font-bold focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all resize-none shadow-inner"}):e.jsx("input",{type:"text",value:x||"",onChange:g=>p(g.target.value),placeholder:m,className:"w-full bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-2xl py-3.5 pl-12 pr-4 text-[11px] font-bold focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all shadow-inner"})]})]}),ne=({onBack:N})=>{var T,H;const[w,x]=n.useState(!0),[p,m]=n.useState(!1),[u,g]=n.useState(!1),[E,P]=n.useState(null),[J,L]=n.useState(!1),B=n.useRef(null),R={nama:"MAN 1 HULU SUNGAI TENGAH",nsm:"131163070001",npsn:"30315354",alamat:"Jl. H. Damanhuri No. 12 Barabai",telepon:"0517-41234",email:"info@man1hst.sch.id",website:"www.man1hst.sch.id",kepalaNama:"Drs. H. Syamsul Arifin",kepalaNip:"196808171995031002",akreditasi:"A (Unggul)",visi:"Mewujudkan Madrasah yang Islami, Mandiri, Amanah, dan Maju melalui keunggulan akademik dan akhlak mulia.",misi:["Menanamkan nilai-nilai religius dalam setiap aspek pembelajaran.","Meningkatkan kompetensi guru dan tenaga kependidikan.","Menyediakan fasilitas pembelajaran berbasis teknologi modern.","Membangun karakter siswa yang tangguh dan berjiwa sosial."],photo:""},[a,l]=n.useState(R),[W,G]=n.useState(R);n.useEffect(()=>{(async()=>{var i,r;if(x(!0),!D&&((i=V)!=null&&i.currentUser))try{const t=await f.collection("users").doc(V.currentUser.uid).get();t.exists&&P((r=t.data())==null?void 0:r.role)}catch(t){console.error("Role check error:",t)}else P(U.ADMIN);if(D){x(!1);return}if(f)try{const t=await f.collection("settings").doc("madrasahInfo").get();if(t.exists){const h=t.data();l(h),G(h)}}catch(t){console.error("Error fetching madrasah info:",t),c.error("Gagal sinkronisasi data dari server.")}finally{x(!1)}})()},[]);const X=s=>new Promise((i,r)=>{const t=new FileReader;t.readAsDataURL(s),t.onload=h=>{var z;const b=new Image;b.src=(z=h.target)==null?void 0:z.result,b.onload=()=>{const k=document.createElement("canvas"),v=1024,y=768;let o=b.width,d=b.height;o>d?o>v&&(d*=v/o,o=v):d>y&&(o*=y/d,d=y),k.width=o,k.height=d;const M=k.getContext("2d");M==null||M.drawImage(b,0,0,o,d),i(k.toDataURL("image/jpeg",.8))}}}),_=async s=>{var r;const i=(r=s.target.files)==null?void 0:r[0];if(i){L(!0);try{const t=await X(i);l(h=>({...h,photo:t})),c.success("Foto berhasil diproses. Jangan lupa klik SIMPAN.")}catch{c.error("Gagal memproses foto.")}finally{L(!1)}}},K=async s=>{if(s.preventDefault(),u)return;if(!a.nama||!a.kepalaNama){c.error("Nama Madrasah dan Kepala Madrasah wajib diisi.");return}g(!0);const i=c.loading("Mengunggah perubahan profil...");try{D?await new Promise(r=>setTimeout(r,1e3)):f&&await f.collection("settings").doc("madrasahInfo").set({...a,updatedAt:new Date().toISOString()},{merge:!0}),G(a),c.success("Profil Madrasah diperbarui!",{id:i}),m(!1)}catch(r){console.error(r),c.error(`Gagal menyimpan: ${r.message}`,{id:i})}finally{g(!1)}},Y=()=>{l(W),m(!1)},$=E===U.ADMIN||E===U.DEVELOPER;return e.jsx(ie,{title:"Profil Madrasah",subtitle:"Identitas & Legalitas Digital",icon:I,onBack:N,actions:$&&!p&&e.jsx("button",{onClick:()=>m(!0),className:"p-2.5 rounded-xl bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 border border-indigo-100 dark:border-indigo-800 shadow-sm active:scale-90 transition-all",children:e.jsx(O,{className:"w-5 h-5"})}),children:e.jsx("div",{className:"p-4 lg:p-8 pb-32 max-w-4xl mx-auto w-full",children:w?e.jsxs("div",{className:"py-20 text-center flex flex-col items-center gap-3",children:[e.jsx(S,{className:"w-10 h-10 animate-spin text-indigo-500 opacity-30"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Sinkronisasi Data..."})]}):p?e.jsxs("form",{onSubmit:K,className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"bg-white dark:bg-[#151E32] p-2 rounded-[3rem] border border-slate-100 dark:border-slate-800 shadow-sm",children:e.jsxs("div",{className:"relative h-64 md:h-80 w-full rounded-[2.5rem] overflow-hidden bg-slate-100 dark:bg-slate-900 flex items-center justify-center group/photo",children:[a.photo?e.jsx("img",{src:a.photo,alt:"Preview Madrasah",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center text-slate-400 flex flex-col items-center gap-4",children:[e.jsx(I,{className:"w-16 h-16 opacity-20"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Belum Ada Foto Instansi"})]}),e.jsxs("button",{type:"button",onClick:()=>{var s;return(s=B.current)==null?void 0:s.click()},className:"absolute inset-0 bg-black/40 backdrop-blur-sm opacity-0 group-hover/photo:opacity-100 transition-all flex flex-col items-center justify-center gap-3 text-white",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-white/20 flex items-center justify-center border border-white/40",children:J?e.jsx(S,{className:"w-6 h-6 animate-spin"}):e.jsx(q,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Unggah Foto Gedung / Banner"})]}),e.jsx("input",{type:"file",ref:B,className:"hidden",accept:"image/*",onChange:_})]})}),e.jsxs("div",{className:"bg-white dark:bg-[#151E32] p-6 lg:p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm space-y-6",children:[e.jsxs("h3",{className:"text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.25em] mb-2 flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-50 dark:bg-indigo-900/30 flex items-center justify-center",children:e.jsx(A,{className:"w-4 h-4"})}),"Identitas & Legalitas"]}),e.jsx(j,{label:"Nama Lengkap Instansi *",icon:I,value:a.nama||"",onChange:s=>l({...a,nama:(s||"").toUpperCase()}),placeholder:"Masukkan nama resmi madrasah"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-5",children:[e.jsx(j,{label:"Nomor Statistik (NSM)",icon:A,value:a.nsm,onChange:s=>l({...a,nsm:s}),placeholder:"12 digit NSM"}),e.jsx(j,{label:"NPSN",icon:A,value:a.npsn,onChange:s=>l({...a,npsn:s}),placeholder:"8 digit NPSN"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest ml-1",children:"Akreditasi"}),e.jsxs("div",{className:"relative group",children:[e.jsx(F,{className:"absolute left-4 top-3.5 w-4 h-4 text-slate-400 group-focus-within:text-amber-500"}),e.jsxs("select",{value:a.akreditasi||"",onChange:s=>l({...a,akreditasi:s.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-2xl py-3.5 pl-11 pr-4 text-[11px] font-bold focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all appearance-none cursor-pointer shadow-inner",children:[e.jsx("option",{value:"",children:"Pilih Akreditasi"}),e.jsx("option",{value:"A (Unggul)",children:"A (Unggul)"}),e.jsx("option",{value:"B (Baik)",children:"B (Baik)"}),e.jsx("option",{value:"C (Cukup)",children:"C (Cukup)"}),e.jsx("option",{value:"Belum Terakreditasi",children:"Belum Terakreditasi"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#151E32] p-6 lg:p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm space-y-6",children:[e.jsxs("h3",{className:"text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.25em] mb-2 flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-50 dark:bg-indigo-900/30 flex items-center justify-center",children:e.jsx(C,{className:"w-4 h-4"})}),"Visi & Misi Strategis"]}),e.jsx(j,{type:"textarea",label:"Visi Madrasah",icon:C,value:a.visi,onChange:s=>l({...a,visi:s}),placeholder:"Tuliskan visi madrasah..."}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Misi Madrasah (Satu per baris)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-4 text-slate-400",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx("textarea",{rows:6,value:((T=a.misi)==null?void 0:T.join(`
`))||"",onChange:s=>l({...a,misi:s.target.value.split(`
`)}),className:"w-full bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 pl-12 text-[11px] font-bold focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all resize-none shadow-inner",placeholder:`Misi 1
Misi 2
Misi 3...`})]})]})]}),e.jsxs("div",{className:"pt-4 flex gap-4 sticky bottom-6 z-20",children:[e.jsx("button",{type:"button",onClick:Y,className:"flex-1 bg-white dark:bg-slate-800 text-slate-500 font-black py-4 rounded-[2rem] border border-slate-200 dark:border-slate-700 active:scale-95 transition-all text-[10px] uppercase tracking-[0.25em] shadow-lg",children:"Batalkan"}),e.jsxs("button",{type:"submit",disabled:u,className:"flex-[2] bg-indigo-600 hover:bg-indigo-700 text-white font-black py-4 rounded-[2rem] shadow-2xl shadow-indigo-500/20 transition-all flex items-center justify-center gap-3 active:scale-[0.98] disabled:opacity-50",children:[u?e.jsx(S,{className:"w-5 h-5 animate-spin"}):e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{className:"uppercase tracking-[0.2em] text-[10px]",children:"Terapkan Perubahan"})]})]})]}):e.jsxs("div",{className:"space-y-8 animate-in fade-in zoom-in duration-500",children:[e.jsxs("div",{className:"relative h-72 md:h-96 w-full rounded-[3.5rem] overflow-hidden bg-indigo-900 shadow-2xl group",children:[a.photo?e.jsx("img",{src:a.photo,alt:a.nama,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-1000"}):e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600 via-indigo-700 to-violet-800"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 flex flex-col md:flex-row items-end justify-between gap-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-14 h-14 bg-white/10 backdrop-blur-xl rounded-2xl p-3 border border-white/20",children:e.jsx(Z,{className:"w-full h-full text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-3xl font-black text-white uppercase tracking-tight leading-none",children:a.nama}),e.jsxs("p",{className:"text-[10px] md:text-xs font-bold text-indigo-200 uppercase tracking-[0.3em] mt-2",children:["NSM: ",a.nsm," â€¢ NPSN: ",a.npsn]})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("span",{className:"bg-yellow-400 text-indigo-950 px-5 py-2 rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-xl",children:["Akreditasi ",a.akreditasi]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-white dark:bg-[#151E32] p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-[0.03] rotate-12",children:e.jsx(C,{className:"w-32 h-32"})}),e.jsxs("h3",{className:"text-xs font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.3em] mb-6 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"})," Visi Utama"]}),e.jsxs("p",{className:"text-sm lg:text-base text-slate-700 dark:text-slate-300 font-bold leading-relaxed italic relative z-10",children:['"',a.visi,'"']})]}),e.jsxs("div",{className:"md:col-span-3 bg-indigo-600 rounded-[2.5rem] p-8 text-white shadow-xl shadow-indigo-500/10",children:[e.jsxs("h3",{className:"text-xs font-black text-indigo-100 uppercase tracking-[0.3em] mb-6 flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"})," Misi Strategis"]}),e.jsx("div",{className:"space-y-4",children:(H=a.misi)==null?void 0:H.map((s,i)=>e.jsxs("div",{className:"flex gap-4 group",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-white/10 flex items-center justify-center text-[10px] font-black shrink-0 border border-white/10 group-hover:bg-white group-hover:text-indigo-600 transition-colors",children:i+1}),e.jsx("p",{className:"text-xs lg:text-sm font-medium leading-relaxed text-indigo-50",children:s})]},i))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#151E32] rounded-[2.5rem] p-8 shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-8",children:[e.jsx("div",{className:"w-32 h-32 rounded-3xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center shrink-0 border border-slate-200 dark:border-slate-700 shadow-inner group overflow-hidden",children:e.jsx(ae,{className:"w-16 h-16 text-slate-300 group-hover:scale-110 transition-transform"})}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("span",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-[0.3em]",children:"Nakhoda Madrasah"}),e.jsx("h3",{className:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-tight mt-1",children:a.kepalaNama}),e.jsxs("p",{className:"text-[11px] font-mono font-bold text-slate-400 mt-1",children:["NIP. ",a.kepalaNip]}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-center md:justify-start gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-slate-500 dark:text-slate-400",children:[e.jsx(se,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{className:"text-xs font-bold",children:a.alamat})]}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-500 dark:text-slate-400",children:[e.jsx(te,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{className:"text-xs font-bold",children:a.website})]})]})]})]})]})})})};export{ne as default};
