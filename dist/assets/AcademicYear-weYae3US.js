import{r as l,j as e,f,C as b,a as N,i as h,d as i,t as c}from"./index-CcQVG4nr.js";import{L as g}from"./Layout-aA6jRwwe.js";const w=({onBack:m})=>{const[d,o]=l.useState([]),[p,n]=l.useState(!0),x=async()=>{if(n(!0),h){o([{id:"1",name:"2023/2024",semester:"Genap",isActive:!0,startDate:"2024-01-02",endDate:"2024-06-20"}]),n(!1);return}if(i)try{const r=(await i.collection("academic_years").orderBy("name","desc").get()).docs.map(a=>({id:a.id,...a.data()}));o(r)}catch{c.error("Gagal memuat tahun ajaran")}finally{n(!1)}};l.useEffect(()=>{x()},[]);const s=d.find(t=>t.isActive),u=async t=>{if(h||!i)return;const r=c.loading("Memperbarui status...");try{const a=i.batch();d.forEach(j=>{a.update(i.collection("academic_years").doc(j.id),{isActive:!1})}),a.update(i.collection("academic_years").doc(t),{isActive:!0}),await a.commit(),c.success("Berhasil diaktifkan",{id:r}),x()}catch{c.error("Gagal",{id:r})}};return e.jsx(g,{title:"Tahun Ajaran",subtitle:"Manajemen Kalender",icon:f,onBack:m,children:e.jsxs("div",{className:"p-6 pb-24 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-violet-700 rounded-3xl p-6 text-white shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full blur-3xl -translate-y-10 translate-x-10"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full text-[10px] font-bold mb-3 border border-white/10 uppercase",children:[e.jsx(b,{className:"w-4 h-4 text-green-300"})," Aktif"]}),e.jsx("p",{className:"text-indigo-200 text-[10px] font-bold uppercase tracking-widest mb-1",children:"Tahun ajaran berjalan"}),e.jsxs("h2",{className:"text-3xl font-black tracking-tight",children:[(s==null?void 0:s.name)||"N/A"," ",e.jsx("span",{className:"opacity-60 text-xl",children:s==null?void 0:s.semester})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white text-lg",children:"Daftar Periode"}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700 overflow-hidden shadow-sm",children:p?e.jsx("div",{className:"py-10 text-center",children:e.jsx(N,{className:"w-8 h-8 animate-spin mx-auto text-indigo-500 opacity-20"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"excel-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nama Tahun Ajaran"}),e.jsx("th",{className:"text-center",children:"Semester"}),e.jsx("th",{className:"text-center",children:"Status"}),e.jsx("th",{className:"text-center w-24",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:d.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-bold text-slate-800 dark:text-white",children:t.name}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:"px-2 py-0.5 rounded text-[9px] font-bold bg-indigo-50 text-indigo-600",children:t.semester})}),e.jsx("td",{className:"text-center",children:t.isActive?e.jsx("span",{className:"text-emerald-500 font-bold text-[9px] uppercase",children:"Aktif"}):e.jsx("span",{className:"text-slate-400 text-[9px] uppercase",children:"Nonaktif"})}),e.jsx("td",{className:"text-center",children:!t.isActive&&e.jsx("button",{onClick:()=>u(t.id),className:"text-indigo-600 font-bold text-[9px] uppercase hover:underline",children:"Aktifkan"})})]},t.id))})]})})})]})]})})};export{w as default};
