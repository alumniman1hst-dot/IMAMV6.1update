import{r as s,U as l,j as e,S as A,w as U,a as k,T as E,z as D,i as w,d as m,t as i}from"./index-CcQVG4nr.js";import{L}from"./Layout-aA6jRwwe.js";const R=({onBack:j,userRole:M})=>{const[r,n]=s.useState("list"),[u,h]=s.useState([]),[p,d]=s.useState(!0),[o,N]=s.useState(""),[g,b]=s.useState(!1),[y,v]=s.useState({displayName:"",email:"",password:"",role:l.GURU,idUnik:""}),c=async()=>{if(d(!0),w){setTimeout(()=>{h([{uid:"1",displayName:"AKHMAD ARIFIN",email:"dev@imam.id",role:l.DEVELOPER},{uid:"2",displayName:"H. SOMERAN, S.PD.,MM",email:"admin@madrasah.id",role:l.ADMIN}]),d(!1)},500);return}if(m)try{const t=await m.collection("users").limit(100).get();h(t.docs.map(a=>({uid:a.id,...a.data()})))}catch{i.error("Gagal mengambil data pengguna.")}finally{d(!1)}};s.useEffect(()=>{c()},[]);const f=s.useMemo(()=>{const t=o.toLowerCase();return u.filter(a=>String(a.displayName).toLowerCase().includes(t)||String(a.email).toLowerCase().includes(t)||String(a.idUnik).includes(t))},[u,o]),S=async t=>{t.preventDefault(),b(!0);const a=i.loading("Mendaftarkan akun...");try{w?await new Promise(x=>setTimeout(x,1e3)):await m.collection("users").add({...y,createdAt:new Date().toISOString()}),i.success("Akun berhasil didaftarkan!",{id:a}),v({displayName:"",email:"",password:"",role:l.GURU,idUnik:""}),n("list"),c()}catch(x){i.error("Gagal: "+x.message,{id:a})}finally{b(!1)}};return e.jsx(L,{title:"Manajemen User",subtitle:"Pusat Kontrol Akses",icon:A,onBack:j,actions:e.jsx("button",{onClick:c,className:"p-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-indigo-600 transition-all",children:e.jsx(D,{className:`w-5 h-5 ${p?"animate-spin":""}`})}),children:e.jsxs("div",{className:"p-4 lg:p-8 pb-32 max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 items-center bg-white dark:bg-[#151E32] p-4 rounded-3xl border border-slate-100 dark:border-slate-800 shadow-sm",children:[e.jsxs("div",{className:"flex p-1 bg-slate-100 dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 w-full md:w-auto",children:[e.jsx("button",{onClick:()=>n("list"),className:`flex-1 md:flex-none px-8 py-2.5 rounded-xl text-[10.5px] font-black uppercase tracking-widest transition-all ${r==="list"?"bg-white dark:bg-slate-700 text-indigo-600 dark:text-white shadow-sm ring-1 ring-black/5":"text-slate-400"}`,children:"Daftar Pengguna"}),e.jsx("button",{onClick:()=>n("create"),className:`flex-1 md:flex-none px-8 py-2.5 rounded-xl text-[10.5px] font-black uppercase tracking-widest transition-all ${r==="create"?"bg-indigo-600 text-white shadow-lg":"text-slate-400"}`,children:"Aktivasi Akses"})]}),r==="list"&&e.jsxs("div",{className:"relative group flex-1 max-w-md w-full",children:[e.jsx(U,{className:"w-4 h-4 absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Filter di memori...",value:o,onChange:t=>N(t.target.value),className:"w-full pl-11 pr-4 py-3.5 bg-slate-50 dark:bg-slate-900 border-none rounded-2xl text-[10.5px] font-bold outline-none focus:ring-4 focus:ring-indigo-500/10 shadow-inner"})]})]}),r==="list"?e.jsxs("div",{className:"bg-white dark:bg-[#151E32] rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden flex flex-col",children:[e.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"excel-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center w-12",children:"No"}),e.jsx("th",{children:"Nama Lengkap User"}),e.jsx("th",{children:"Alamat Email"}),e.jsx("th",{className:"text-center",children:"Level Akses"}),e.jsx("th",{className:"text-center",children:"ID Unik"}),e.jsx("th",{className:"text-center w-24",children:"Aksi"})]})}),e.jsx("tbody",{children:p?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-24 text-center",children:e.jsx(k,{className:"w-10 h-10 animate-spin mx-auto text-indigo-500 opacity-20"})})}):f.length>0?f.map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center font-mono text-slate-400 font-bold",children:a+1}),e.jsx("td",{className:"font-black text-slate-800 dark:text-slate-200 uppercase tracking-tight",children:t.displayName}),e.jsx("td",{className:"text-slate-500 font-bold lowercase",children:t.email}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest ${t.role===l.DEVELOPER?"bg-slate-950 text-indigo-400":"bg-indigo-50 text-indigo-600"}`,children:t.role})}),e.jsx("td",{className:"text-center font-mono text-indigo-600 dark:text-indigo-400 font-black tracking-widest",children:t.idUnik||"-"}),e.jsx("td",{className:"text-center",children:e.jsx("button",{className:"p-2 text-slate-300 hover:text-rose-600",children:e.jsx(E,{className:"w-4 h-4"})})})]},t.uid)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-24 text-center text-[10.5px] font-black text-slate-400 uppercase tracking-widest",children:"Data tidak ditemukan"})})})]})}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 flex justify-between items-center border-t border-slate-200 dark:border-slate-700",children:e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Quota Saving Mode Active"})})]}):e.jsx("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#151E32] rounded-[3rem] p-8 lg:p-12 border border-slate-100 dark:border-slate-800 shadow-xl animate-in zoom-in duration-500",children:e.jsx("form",{onSubmit:S,className:"space-y-6",children:e.jsx("button",{type:"submit",disabled:g,className:"w-full py-4.5 bg-indigo-600 text-white font-black rounded-[2rem] text-[10.5px] uppercase tracking-[0.3em] shadow-2xl active:scale-[0.98] disabled:opacity-50",children:g?e.jsx(k,{className:"w-5 h-5 animate-spin"}):"Simpan Akun Baru"})})})]})})};export{R as default};
