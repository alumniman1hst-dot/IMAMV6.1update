import{r as t,j as e,q as E,a as f,T as L,t as i,x as M,i as D,d as g,U as N}from"./index-CcQVG4nr.js";import{d as A,a as I}from"./studentService-CIZKz8Ta.js";const R=({onBack:w,userRole:c})=>{const[d,o]=t.useState("list"),[l,k]=t.useState(null),[n,r]=t.useState("students"),[v,x]=t.useState([]),[m,y]=t.useState([]),[S,h]=t.useState(!0),[C,p]=t.useState(!1),b=c===N.ADMIN||c===N.DEVELOPER;t.useEffect(()=>{(async()=>{h(!0);try{if(D)x([{id:"1",name:"X IPA 1",level:"10",academicYear:"2023/2024"}]);else if(g){const a=await g.collection("classes").get();x(a.docs.map(j=>({id:j.id,...j.data()})))}}catch{i.error("Gagal sinkronisasi data kelas")}finally{h(!1)}})()},[]);const u=async s=>{k(s),o("detail"),r("students"),p(!0);try{const a=await I(s.name);y(a)}catch{i.error("Gagal memuat data siswa kelas")}finally{p(!1)}};return e.jsxs("div",{className:"flex flex-col h-full bg-[#f8fafc] dark:bg-[#020617] overflow-hidden",children:[e.jsx("div",{className:"bg-white/80 dark:bg-[#0B1121]/80 backdrop-blur-xl px-5 py-4 flex items-center justify-between border-b border-slate-100 dark:border-slate-800 safe-pt z-40",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:d==="detail"?()=>o("list"):w,className:"p-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-[10px] font-bold text-slate-900 dark:text-white leading-none uppercase tracking-widest",children:d==="detail"?l==null?void 0:l.name:"Rombongan belajar"}),e.jsx("p",{className:"text-[10px] font-medium text-indigo-600 mt-1.5",children:"Manajemen kelas"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:S?e.jsx("div",{className:"py-20 text-center",children:e.jsx(f,{className:"w-10 h-10 animate-spin text-indigo-500 opacity-20 mx-auto"})}):d==="list"?e.jsx("div",{className:"p-5 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:v.map(s=>e.jsxs("div",{onClick:()=>u(s),className:"bg-white dark:bg-[#151E32] p-5 rounded-[2rem] border border-slate-100 dark:border-slate-800 shadow-sm hover:shadow-xl cursor-pointer transition-all",children:[e.jsx("h4",{className:"text-base font-bold text-slate-800 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-[10px] font-medium text-slate-400 mt-1",children:["Tapel: ",s.academicYear]})]},s.id))}):e.jsxs("div",{className:"p-5 lg:p-8 space-y-6",children:[e.jsxs("div",{className:"flex p-1 bg-slate-100 dark:bg-[#151E32] rounded-2xl w-fit border border-slate-200 shadow-inner",children:[e.jsx("button",{onClick:()=>r("students"),className:`px-8 py-2.5 rounded-xl text-[10px] font-bold transition-all ${n==="students"?"bg-white text-indigo-600 shadow-sm":"text-slate-400"}`,children:"Daftar siswa"}),e.jsx("button",{onClick:()=>r("subjects"),className:`px-8 py-2.5 rounded-xl text-[10px] font-bold transition-all ${n==="subjects"?"bg-white text-indigo-600 shadow-sm":"text-slate-400"}`,children:"Mata pelajaran"})]}),n==="students"&&e.jsxs("div",{className:"bg-white dark:bg-[#151E32] rounded-[2rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden flex flex-col",children:[e.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"excel-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center w-12",children:"No"}),e.jsx("th",{children:"Nama lengkap peserta didik"}),e.jsx("th",{className:"text-center",children:"Gender"}),e.jsx("th",{className:"text-center",children:"Status"}),b&&e.jsx("th",{className:"text-center w-24",children:"Aksi"})]})}),e.jsx("tbody",{children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-10 text-center",children:e.jsx(f,{className:"w-6 h-6 animate-spin mx-auto text-indigo-500 opacity-20"})})}):m.length>0?m.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center font-mono text-slate-400",children:a+1}),e.jsx("td",{className:"font-bold text-slate-800 dark:text-slate-200",children:s.namaLengkap}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[9px] font-bold ${s.jenisKelamin==="Perempuan"?"text-rose-500 bg-rose-50":"text-blue-500 bg-blue-50"}`,children:s.jenisKelamin==="Perempuan"?"P":"L"})}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-600 text-[9px] font-bold",children:s.status})}),b&&e.jsx("td",{className:"text-center",children:e.jsx("button",{onClick:async()=>{window.confirm("Hapus siswa dari sistem?")&&(await A(s.id),u(l),i.success("Berhasil dihapus"))},className:"p-1 rounded-lg hover:bg-slate-100 text-slate-300 hover:text-rose-600 transition-all",children:e.jsx(L,{className:"w-3 h-3"})})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-20 text-center text-[10px] font-bold text-slate-400",children:"Rombel belum memiliki data siswa"})})})]})}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 flex justify-between items-center border-t border-slate-200",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400",children:"Menampilkan maks. 50 siswa per kelas"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[9px] font-black text-indigo-400 uppercase tracking-widest",children:[e.jsx(M,{className:"w-3 h-3"})," Quota Optimized"]})]})]})]})})]})};export{R as default};
