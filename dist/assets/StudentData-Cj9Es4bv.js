import{r as a,j as e,o as I,w as E,a5 as A,a as D,x as M,z as R,t as U,U as k}from"./index-CcQVG4nr.js";import{g as O}from"./studentService-CIZKz8Ta.js";import{L as B}from"./Layout-aA6jRwwe.js";const H=({onBack:N,userRole:h})=>{const[r,w]=a.useState([]),[p,f]=a.useState(!0),[x,S]=a.useState(""),[o,v]=a.useState("All"),[P,y]=a.useState(!1),[z,G]=a.useState(null),[Q,T]=a.useState(!1),[n,$]=a.useState({key:"namaLengkap",direction:"asc"}),g=async(t=!1)=>{f(!0);try{const s=await O(t);w(s)}catch{U.error("Gagal sinkronisasi data")}finally{f(!1)}};a.useEffect(()=>{g()},[]);const C=a.useMemo(()=>Array.from(new Set(r.map(s=>s.tingkatRombel).filter(Boolean))).sort((s,l)=>s.localeCompare(l,void 0,{numeric:!0})),[r]),m=a.useMemo(()=>{const t=x.toLowerCase().trim();let s=r.filter(l=>{const u=String(l.namaLengkap).toLowerCase().includes(t)||String(l.nisn).includes(t)||String(l.idUnik).includes(t),c=o==="All"||l.tingkatRombel===o;return u&&c});return n.direction&&n.key!=="aksi"&&(s=[...s].sort((l,u)=>{const c=n.key,i=l[c]??"",d=u[c]??"";if(typeof i=="number"&&typeof d=="number")return n.direction==="asc"?i-d:d-i;const b=String(i).toLowerCase(),j=String(d).toLowerCase();return n.direction==="asc"?b.localeCompare(j):j.localeCompare(b)})),s},[r,x,o,n]),L=h===k.ADMIN||h===k.DEVELOPER;return e.jsx(B,{title:"Data Siswa",subtitle:"Manajemen Data Induk",icon:I,onBack:N,actions:e.jsx("button",{onClick:()=>g(!0),className:"p-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-indigo-600 transition-all",children:e.jsx(R,{className:`w-5 h-5 ${p?"animate-spin":""}`})}),children:e.jsxs("div",{className:"p-4 lg:p-6 pb-32 space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between items-center bg-white dark:bg-[#151E32] p-4 rounded-3xl border border-slate-100 dark:border-slate-800 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row flex-1 w-full gap-3",children:[e.jsxs("div",{className:"relative flex-[2]",children:[e.jsx(E,{className:"w-4 h-4 absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Cari di memori lokal...",value:x,onChange:t=>S(t.target.value),className:"w-full bg-slate-50 dark:bg-slate-900 border-none rounded-2xl py-3 pl-12 text-[10.5px] font-bold outline-none focus:ring-2 focus:ring-indigo-500/20 shadow-inner"})]}),e.jsx("div",{className:"relative flex-1 min-w-[140px]",children:e.jsxs("select",{value:o,onChange:t=>v(t.target.value),className:"w-full bg-slate-50 dark:bg-slate-900 border-none rounded-2xl py-3 px-4 text-[10.5px] font-bold outline-none appearance-none cursor-pointer text-slate-700 dark:text-slate-300 shadow-inner",children:[e.jsx("option",{value:"All",children:"Semua rombel"}),C.map(t=>e.jsx("option",{value:t,children:t},t))]})})]}),L&&e.jsxs("button",{onClick:()=>y(!0),className:"w-full lg:w-auto px-6 py-3 bg-indigo-600 text-white rounded-2xl text-[10.5px] font-bold flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-all",children:[e.jsx(A,{className:"w-4 h-4"})," Tambah Siswa"]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#151E32] rounded-[2rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden flex flex-col",children:[e.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"excel-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center w-12",children:"No"}),e.jsx("th",{children:"Nama Lengkap"}),e.jsx("th",{className:"text-center",children:"NISN"}),e.jsx("th",{className:"text-center",children:"ID Unik"}),e.jsx("th",{className:"text-center",children:"Rombel"}),e.jsx("th",{className:"text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:p?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-20 text-center",children:e.jsx(D,{className:"w-8 h-8 animate-spin mx-auto text-indigo-500 opacity-20"})})}):m.length>0?m.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center font-mono text-slate-400",children:s+1}),e.jsx("td",{className:"font-bold text-slate-800 dark:text-slate-200",children:t.namaLengkap}),e.jsx("td",{className:"text-center font-mono",children:t.nisn}),e.jsx("td",{className:"text-center font-mono text-indigo-600 font-bold",children:t.idUnik||"-"}),e.jsx("td",{className:"text-center font-black",children:t.tingkatRombel}),e.jsx("td",{className:"text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[9px] font-black ${t.status==="Aktif"?"bg-emerald-50 text-emerald-600":"bg-slate-50 text-slate-400"}`,children:t.status})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-20 text-center text-slate-400 font-bold",children:"Data tidak ditemukan"})})})]})}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 flex justify-between items-center border-t border-slate-200 dark:border-slate-700",children:[e.jsxs("p",{className:"text-[10px] font-black text-slate-400",children:["Total: ",m.length," entri"]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[9px] font-black text-indigo-400 uppercase tracking-widest",children:[e.jsx(M,{className:"w-3.5 h-3.5"})," Cache Optimization Enabled"]})]})]})]})})};export{H as default};
